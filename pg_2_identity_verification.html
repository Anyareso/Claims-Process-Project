<section id="page_two">
    <style>
        @import "css/styles.css";
        @import "css/camera-styles.css";
    </style>

    <div class="bg-svg"></div>
        <h3>Identity Verification</h3>
        <p>Please enable your camera in order to take a selfie. Remember to look straight into the camera.</p>
    <div>
    <!-- Camera Section -->
    
    <!-- Stream the video via webcam  -->
    <div class="identity-ver">
      <div class="video-wrap">
        <video id="video" playsinline autoplay></video>
        <!-- Trigger canvas web API -->
        <div class="controller">
          <button id="snap">Capture</button>
        </div>
      </div>
      <div class="canvas-container">
        <h4>Check Selfie</h4>
        <p>Make sure your selfie clearly shows your face</p>
        <canvas id="canvas" width="300" height="300"></canvas>
        <div class="canvas-btn">
          <button id="redo">Redo</button>
          <button id="confirm">Confirm</button>
        </div>
      </div>

    </div>
  
  </br>

    <div class="btn-group">
        <button type="button" class="btn-prev" disabled>Back</button>
        <button type="button" class="btn-next">Next Step</button>
    </div>

    <script>
      'use strict';

      const video = document.getElementById('video');
      const canvas = document.getElementById('canvas');
      const snap = document.getElementById('snap');
      const context = canvas.getContext('2d');
      const redo = document.getElementById('redo');
      const confirm = document.getElementById('confirm');
      
      const constraints = {
          audio: false,
          video: {
              width: 320, 
              height: 320
          }
      };

      // Access Webcam
      async function init() {
          try {
              const stream = await navigator.mediaDevices.getUserMedia(constraints);
              handleSuccess(stream);
          } catch (e) {
              console.error('navigator.getUserMedia error:', e);
          }
      }

      // Success
      function handleSuccess(stream) {
          window.stream = stream;
          video.srcObject = stream;
      }

      // Load init
      init();

      // Draw Image
      snap.addEventListener("click", function () {
          context.drawImage(video, 0, 0, canvas.width, canvas.height);
      });

      // Clearing canvas
      redo.addEventListener("click", function () {
          context.clearRect(0, 0, canvas.width, canvas.height);
      });

      // Saving the image
      confirm.addEventListener("click", function () {
          const imageData = canvas.toDataURL();
          const link = document.createElement('a');
          link.href = imageData;
          link.download = 'selfie.png';
          link.click();
          // const image = new Image();
          // image.src = imageData;
          // // Now you can use the image as needed
          // // For example, you can append it to the page
          // document.body.appendChild(image);
      });
    </script>

</section>