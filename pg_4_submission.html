<section id="page-three">
    <style>
        @import "css/styles.css";
        @import "css/submission.css";
    </style>

    <!-- final submission page -->
    <div class="bg-svg"></div>
        <h3>Submission</h3>
        <p>Please sign and accept the data protection clause in order for you to submit successfully.</p>

    <!-- signature section -->
    <div class="signature-box">
        <label for="signature">Sign Here:</label>
        <canvas id="signature-pad-1" class="signature-pad" width="250" height="150"></canvas>
        <div class="buttons">
            <button class="cancel" id="cancel-1">Cancel</button>
            <button class="accept" id="accept-1">Accept</button>
        </div>
    </div>    

    <!-- personal relief section -->
    <div class="form-group">
        <label>Do you want Personal Relief?</label>
        <input type="radio" name="personal-relief" id="personal-relief-yes">
        <label for="personal-relief-yes">Yes</label>
        <input type="radio" name="personal-relief" id="personal-relief-no">
        <label for="personal-relief-no">No</label>
    </div>

    <details id="personal-relief-section" style="display: none;">
        <summary>
            Personal Relief Details
        </summary> 
        <div class="form-group personal-relief-request">
            <h4>Personal Relief Request</h4>
            <p>
                I <input id="client-name" type="text"></hr> ID No. <input type="number"></hr> being an annuitant under the Sanlam Insurance Limited (‘Sanlam’) Policy/Annuity No. <input type="text"></hr> do hereby confirm that the annuity payout is my main source of income and will claim for the applicable personal relief on the said income from Sanlam and not from other source for tax purposes.

                I, the above mentioned and undersigned having taken up my right to claim for tax relief and hereby indemnify Sanlam Life Insurance Limited according to the terms set forth here follows:

                </br>

                <ol>
                    <li>
                        I undertake that Sanlam shall not bear ultimate responsibility, whether in contract, or (including negligence), breach of statutory duty, equity or otherwise, to myself in any respect for any principal tax, penalties and interest suffered by myself howsoever arising from the subject matter claim.
                    </li>
                    <li>
                        I undertake to indemnify and hold Sanlam life insurance harmless from and against any and all loss suffered by the Company                                         
                        howsoever arising in regard to the subject matter claim.
                    </li>
                    <li>I agree that - 
                        <ol class="lowercase-list">
                            <li>
                                This declaration shall apply to my personal representatives, successors, assigns in title and any|or all authorised representatives.
                            </li>
                            <li>
                                Nothing in this declaration shall exclude or in any way limit Sanlam Life insurance liability to fraud or any other liability to the extent such liability may not be excluded or limited as a matter of the Laws of Kenya.
                            </li>
                            <li>
                                If any provision of this declaration is prohibited by Law or judged in a Court to be unlawful, void or unenforceable, the provision shall, to the extent required, be severed from this Agreement and rendered ineffective as far as possible without modifying the remaining provisions of this Agreement and shall not in any way affect any other circumstances of or the validity or enforcement of this Agreement.
                            </li>
                        </ol>
                    </li>
                </ol>

                </br>

                I/We hereby declare the truth and correctness of all the statements and particulars entered in this application and that I have not withheld any material information, and that my/our answers herein are in my/our full knowledge and have been written by me/us or with my/our full authority.             
            </p>

            </br>

            <div class="personal-relief-request-signatures">
                <!-- first annuitants signature -->
                <div class="signature-box" id="first-signature">
                    <label for="signature">Sign Here:</label>
                    <canvas id="signature-pad-2" class="signature-pad" width="250" height="150"></canvas>
                    <div class="buttons">
                        <button class="cancel" id="cancel-2">Cancel</button>
                        <button class="accept" id="accept-2">Accept</button>
                    </div>
                </div>
                

                <!-- second annuitants signature -->
                <div class="signature-box" id="second-signature">
                    <label for="signature">Sign Here:</label>
                    <canvas id="signature-pad-3" class="signature-pad" width="250" height="150"></canvas>
                    <div class="buttons">
                        <button class="cancel" id="cancel-3">Cancel</button>
                        <button class="accept" id="accept-3">Accept</button>
                    </div>
                </div>
            </div>            
        </div> 
        
    </details>

    </br>
    
    <!-- data protection checbox -->
    <div class="form-group">
        <input type="checkbox" id="data-protection">
        <label for="data-protection">I agree that I have read and understood the <a href="#">Data Protection Notice</a>.</label>
    </div>

    </br>

    <div class="btn-group">
        <button type="button" class="btn-prev">Back</button>
        <button type="button" class="btn-submit">Submit</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"></script>
    <script src="js/signature-pad.js"></script>
    <script>
            document.addEventListener("DOMContentLoaded", function() {
            var signaturePads = [];
            
            function initializeSignaturePad(canvasId, cancelBtnId, acceptBtnId) {
                var canvas = document.getElementById(canvasId);
                if (!canvas) {
                    console.error("Canvas element with ID " + canvasId + " not found.");
                    return;
                }

                var signaturePad = new SignaturePad(canvas);
                signaturePads.push(signaturePad);

                var cancelBtn = document.getElementById(cancelBtnId);
                if (cancelBtn) {
                    cancelBtn.addEventListener("click", function() {
                        signaturePad.clear();
                    });
                } else {
                    console.error("Cancel button with ID " + cancelBtnId + " not found.");
                }

                var acceptBtn = document.getElementById(acceptBtnId);
                if (acceptBtn) {
                    acceptBtn.addEventListener("click", function() {
                        if (signaturePad.isEmpty()) {
                            alert("Please provide a signature first.");
                        } else {
                            var dataURL = signaturePad.toDataURL();
                            console.log("Signature accepted:", dataURL);
                        }
                    });
                } else {
                    console.error("Accept button with ID " + acceptBtnId + " not found.");
                }
            }

            // Initialize signature pads
            initializeSignaturePad("signature-pad-1", "cancel-1", "accept-1");
            initializeSignaturePad("signature-pad-2", "cancel-2", "accept-2");
            initializeSignaturePad("signature-pad-3", "cancel-3", "accept-3");

            // Personal relief section handling
            var personalReliefYes = document.getElementById("personal-relief-yes");
            var personalReliefNo = document.getElementById("personal-relief-no");
            var personalReliefSection = document.getElementById("personal-relief-section");

            if (personalReliefYes && personalReliefNo && personalReliefSection) {
                personalReliefYes.addEventListener("change", function() {
                    if (this.checked) {
                        personalReliefSection.style.display = "block";
                    }
                });

                personalReliefNo.addEventListener("change", function() {
                    if (this.checked) {
                        personalReliefSection.style.display = "none";
                    }
                });
            } else {
                if (!personalReliefYes) {
                    console.error("Personal relief 'Yes' radio button not found.");
                }
                if (!personalReliefNo) {
                    console.error("Personal relief 'No' radio button not found.");
                }
                if (!personalReliefSection) {
                    console.error("Personal relief section not found.");
                }
            }
        });

        function clearSignature(id) {
            var signaturePad = signaturePads.find(function(pad) {
                return pad._canvas.id === id;
            });

            if (!signaturePad) {
                console.error("Signature pad with ID " + id + " not found.");
                return;
            }

            signaturePad.clear();
        }
    </script>
</section>
